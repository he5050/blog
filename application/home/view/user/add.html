<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title>H+ 新增用户</title>
    <meta name="keywords" content="H+">
    <meta name="description" content="H">

    <link rel="shortcut icon" href="__HOME__/favicon.ico">
    <link href="__HOME__css/bootstrap.min.css" rel="stylesheet">
    <link href="__HOME__css/font-awesome.css" rel="stylesheet">
    <link href="__HOME__css/animate.css" rel="stylesheet">
    <link href="__HOME__css/style.css" rel="stylesheet">
    <link href="__HOME__css/plugins/chosen/chosen.css" rel="stylesheet">
    <link href="__HOME__css/plugins/sweetalert/sweetalert.css" rel="stylesheet">

</head>

<body class="gray-bg">
    <div class="wrapper wrapper-content animated fadeInRight">
        <div class="row">
            <div class="col-sm-6 col-md-offset-3">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                       <a class="text-info" title="点击我刷新"><h5>添加用户<small>编辑用户的详细信息</small></h5><i class="fa fa-refresh fa-spin"></i></a>
                        <div class="ibox-tools">
                            <a class="collapse-link">
                                <i class="fa fa-chevron-up"></i>
                            </a>
                            <a class="dropdown-toggle" data-toggle="dropdown" href="form_basic.html#">
                                <i class="fa fa-wrench"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-user">
                                <li><a href="form_basic.html#">选项1</a>
                                </li>
                                <li><a href="form_basic.html#">选项2</a>
                                </li>
                            </ul>
                            <a class="close-link">
                                <i class="fa fa-times"></i>
                            </a>
                        </div>
                    </div>
                    <div class="ibox-content">
                        <form class="form-horizontal m-t" id="user" action="{:url('home/user/add')}" method="post">
                            <div class="form-group">
                                <label class="col-sm-3 control-label">用户名*</label>
                                <div class="col-sm-8">
                                    <input id="username" name="username" class="form-control" type="text">
                                    <span class="help-block m-b-none"><i class="fa fa-info-circle"></i>输入注册的用户名</span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">真实姓名</label>
                                <div class="col-sm-8">
                                    <input id="userrname" name="userrname" class="form-control" type="text" aria-required="true" aria-invalid="false" class="valid">
                                    <span class="help-block m-b-none"><i class="fa fa-info-circle"></i>用户真实姓名</span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">用户昵称</label>
                                <div class="col-sm-8">
                                    <input id="usersname" name="usersname" class="form-control" type="text" aria-required="true" aria-invalid="false" class="valid">
                                    <span class="help-block m-b-none"><i class="fa fa-info-circle"></i>用户昵称</span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">手机号</label>
                                <div class="col-sm-8">
                                    <input id="userphone" name="userphone" class="form-control" type="text" aria-required="true" aria-invalid="true" class="error">
                                    <span class="help-block m-b-none"><i class="fa fa-info-circle"></i>用户的手机号</span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">身份证号</label>
                                <div class="col-sm-8">
                                    <input id="usercard" name="usercard" class="form-control" type="text" aria-required="true" aria-invalid="true" class="error">
                                    <span class="help-block m-b-none"><i class="fa fa-info-circle"></i>身份证号</span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">密码：</label>
                                <div class="col-sm-8">
                                    <input id="password" name="password" class="form-control" type="password">
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">确认密码：</label>
                                <div class="col-sm-8">
                                    <input id="confirm_password" name="confirm_password" class="form-control" type="password">
                                    <span class="help-block m-b-none"><i class="fa fa-info-circle"></i> 请再次输入您的密码</span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">E-mail：</label>
                                <div class="col-sm-8">
                                    <input id="email" name="email" class="form-control" type="email">
                                    <span class="help-block m-b-none"><i class="fa fa-info-circle"></i>用户的邮箱，用于激活账号</span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">姓别：</label>
                                <div class="col-sm-8">
                                    <input id="sex" name="sex" class="" type="radio" value="1" checked>男
                                    <input id="sex" name="sex" class="" type="radio" value="0">女
                                    <span class="help-block m-b-none"><i class="fa fa-info-circle"></i>用户的姓别</span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">所在用户组：</label>
                                <div class="col-sm-8">
                                            <input type="checkbox"  value="0" id="check" name="group[]" checked onclick="return false;">普通用户组
                                   {volist name="group" id="gp"}
                                       <input  name="group[]" class="group" type="checkbox" value="{$gp.id}">{$gp.title}
                                   {/volist}
                                    
                                    <span class="help-block m-b-none"><i class="fa fa-info-circle"></i>用户所在权限组</span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">地址信息：</label>
                                <div class="col-sm-8">
                                       <div class="row">
                                           <div class="col-sm-6">
                                                <select data-placeholder="选择地区..." class="chosen-select"  tabindex="2" name="a1" id="a1" type="text" >
                                                    <option hassubinfo="true" value="">请选择地区</option>
                                                    {volist name="area" id="vo"}
                                                        <option hassubinfo="true" value="{$vo.charArea}">{$vo.charArea}--{$vo.charAreaen}</option>
                                                    {/volist}
                                                </select>
                                           </div>
                                           <div  class="col-sm-3">
                                                <select data-placeholder="选择省市..." class="chosen-select"  tabindex="2" name="a2" id="a2" type="text">
                                                    <option value="">请选择省市</option>
                                                </select>
                                           </div>
                                           <div data-placeholder="选择区县..." class="chosen-select"  tabindex="2"  class="col-sm-3">
                                                <select name="a3" id="a3" type="text">
                                                <option value="">请选择区县</option>
                                                </select>
                                           </div>
                                       </div>
                                            <input id="areainfo" name="areainfo" class="form-control" type="text" >
                                            <span class="help-block m-b-none"><i class="fa fa-info-circle"></i>请输入您的地址</span>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <div class="col-sm-8 col-sm-offset-3">
                                    <div class="checkbox">
                                        <label>
                                            <input type="checkbox" class="checkbox" id="agree" name="agree"> 我已经认真阅读并同意《H+使用协议》
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-sm-8 col-sm-offset-3">
                                    <button id="sub" class="btn btn-primary" type="submit" disabled="disabled">提交</button>
                                    <button  class="btn btn-primary" type="button" onclick="window.location.href='{:url('home/user/list')}'">返回</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

    </div>


    <!-- 全局js -->
    <script src="__HOME__js/jquery.min.js"></script>
    <script src="__HOME__js/bootstrap.min.js"></script>

    <!-- 自定义js -->
    <script src="__HOME__js/content.js"></script>
    <script src="__HOME__js/plugins/sweetalert/sweetalert.min.js"></script>
    <script src="__HOME__js/plugins/validate/jquery.validate.min.js"></script>
    <script src="__HOME__js/plugins/validate/messages_zh.min.js"></script>
    <script src="__HOME__js/demo/form-validate-demo.js"></script>
    {js href="__HOME__js/jquery.form.js" /}
    <script type="text/javascript">
        $("#agree").click(function () {
            swal({
                    title: "是否阅读相关谢谢",
                    text: "请认真阅读",
                    type: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "是的，我同意",
                    cancelButtonText: "让我再考虑一下…",
                    closeOnConfirm: false,
                    closeOnCancel: false
                },
                function (isConfirm) {
                    if (isConfirm) {
                        swal("您选择同意了", "欢迎您的加入", "success");
                        $('#sub').removeAttr('disabled');
                    } else {
                        swal("已取消", "请重新考虑", "error");
                        $("#agree").prop('checked', false);
                        $('#sub').attr('disabled', 'disabled');
                    }
                });
        });
        //二级联动
        $('#a1').change(function(){
            var area = $(this).val();
            $.post("{:url('home/user/add')}",{info:1,area:area},function(msg){
                //取得省市JQ对象
                var sel2 = $('#a2');
                //清空
                sel2.empty();
                //添加顶级分类
                sel2.append(new Option('请选择省市'));
                $(msg).each(function(i){
                    var ll = msg[i].charProvince + '--' + msg[i].charShortProvince;
                    //添加获取到的省市信息
                    var op = new Option(ll,msg[i].charProvince);
                    sel2.append(op);
                });
            },'json');
        });
       //三级联动
        $('#a2').change(function(){
            var area = $(this).val();
            $.post("{:url('home/user/add')}",{info:2,area:area},function(msg){
                //取得省市JQ对象
                var sel3 = $('#a3');
                //清空
                sel3.empty();
                //添加顶级分类
                sel3.append(new Option('请选择区县'));
                $(msg).each(function(i){
                    var ll = msg[i].charCity + '--' + msg[i].charCityen;
                    //添加获取到的省市信息
                    var op = new Option(ll,msg[i].charCity);
                    sel3.append(op);
                });
            },'json');
        });
        $("select").change(function () {
                var a1 = $("#a1").val();
                var a2 = $("#a2").val();
                var a3 = $('#a3').val();
               if(a1 && a2 && a3){
                   var area =$("#areainfo").val(a1+'-'+a2+'-'+a3+'----'+'');
               }
        });
        (function(){
          var options = {success : showInfo};
          $('#user').ajaxForm(options);
          function showInfo(msg){
             if(msg.status == 1){
                    swal({
                        title: "添加用户成功",
                        text: "即将跳转到用户列表",
                        type: "success"
                    },function(){
                        //刷新当前页面
                         //window.location.reload();
                        window.location.href="{:url('home/user/list')}";
                    });
                }else{
                   swal({
                        title: "好像出了点什么问题!",
                        text: "请您重新在试试",
                        type: "warning",
                        confirmButtonColor: "#DD6B55",
                        confirmButtonText: "添加用户失败!",
                        closeOnConfirm: false,
                        closeOnCancel: false
                    });
                }
          }  
      })();
    </script>
</body>

</html>